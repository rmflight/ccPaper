<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Hypothetical Example</title>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}
</style>



</head>

<body>
<!--
  %\VignetteEngine{knitr}
  %\VignetteIndexEntry{hypothetical example}
  %\VignetteDepends{categoryComparePaperRev, ggplot2}
-->

<h1>Hypothetical Example</h1>

<p>To demonstrate the utility of the general <code>categoryCompare</code> approach, we will construct an artificial data set based on the Gene Ontology. We will attempt to demonstrate that differences in the <strong>set</strong> or <strong>list</strong> based comparisons are also dependent on the number of items annotated to a particular term.</p>

<h2>Definitions</h2>

<p><strong>Set</strong> based: calculations performed independently on each <em>set</em> of features, and then the results are combined.</p>

<p><strong>List</strong> based: calculations performed on the intersected <em>list</em> of two sets of features.</p>

<h2>GO Terms</h2>

<pre><code class="r">nGO &lt;- 20
</code></pre>

<p>We will make use of three sets of 20 GO terms from <em>H. sapiens</em>. For each set, we want differing numbers of genes annotated to them.</p>

<h3>Num Annotations Dist</h3>

<p>Let&#39;s first look at the distribution of number of genes annotated to the GO terms in <strong>biological process</strong></p>

<pre><code class="r">library(org.Hs.eg.db)
</code></pre>

<pre><code>## Loading required package: AnnotationDbi
## Loading required package: BiocGenerics
## Loading required package: parallel
## 
## Attaching package: &#39;BiocGenerics&#39;
## 
## The following objects are masked from &#39;package:parallel&#39;:
## 
##     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
##     clusterExport, clusterMap, parApply, parCapply, parLapply,
##     parLapplyLB, parRapply, parSapply, parSapplyLB
## 
## The following object is masked from &#39;package:stats&#39;:
## 
##     xtabs
## 
## The following objects are masked from &#39;package:base&#39;:
## 
##     anyDuplicated, append, as.data.frame, as.vector, cbind,
##     colnames, duplicated, eval, evalq, Filter, Find, get,
##     intersect, is.unsorted, lapply, Map, mapply, match, mget,
##     order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,
##     rbind, Reduce, rep.int, rownames, sapply, setdiff, sort,
##     table, tapply, union, unique, unlist
## 
## Loading required package: Biobase
## Welcome to Bioconductor
## 
##     Vignettes contain introductory material; view with
##     &#39;browseVignettes()&#39;. To cite Bioconductor, see
##     &#39;citation(&quot;Biobase&quot;)&#39;, and for packages &#39;citation(&quot;pkgname&quot;)&#39;.
## 
## Loading required package: DBI
</code></pre>

<pre><code class="r">library(GO.db)
</code></pre>

<pre><code>## 
</code></pre>

<pre><code class="r">library(ccPaperRev)
</code></pre>

<pre><code>## Loading required package: categoryComparePaperRev
</code></pre>

<pre><code>## Warning: the specification for S3 class &quot;AsIs&quot; in package &#39;XMLRPC&#39; seems
## equivalent to one from package &#39;BiocGenerics&#39; and is not turning on
## duplicate class definitions for this class
</code></pre>

<pre><code class="r">hsGO &lt;- as.list(org.Hs.egGO2ALLEGS)

goOntology &lt;- Ontology(names(hsGO))
goBP &lt;- names(goOntology)[goOntology == &quot;BP&quot;]
hsGO &lt;- hsGO[goBP]
hsGO &lt;- lapply(hsGO, unique)
universeGenes &lt;- unique(unlist(hsGO))
</code></pre>

<pre><code class="r">library(ggplot2)
hsGO_count &lt;- sapply(hsGO, length)
hsGO_count &lt;- data.frame(count = hsGO_count)
ggplot(hsGO_count, aes(x = count)) + geom_bar(binwidth = 10) + xlim(0, 2000) + 
    ylim(0, 500)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk goCountDist"/> </p>

<h3>Set up groups</h3>

<pre><code class="r">minGO &lt;- 10
</code></pre>

<p>Let us define a minimum number of genes that need to be annotated to a GO term (10), and then divide the GO terms into groups that we can subsequently take random samples from.</p>

<pre><code class="r">grpLow &lt;- c(10, 100)
grpMed &lt;- c(250, 500)
grpHi &lt;- c(500, 1500)
</code></pre>

<pre><code class="r">set.seed(271113)  # for reproducibility
nGO &lt;- 20

GO_low &lt;- limitedRandomSample(hsGO_count, grpLow, nGO)
GO_med &lt;- limitedRandomSample(hsGO_count, grpMed, nGO)
GO_hi &lt;- limitedRandomSample(hsGO_count, grpHi, nGO)
</code></pre>

<h3>Get Genes</h3>

<p>Now, for all of these we need to generate <strong>two</strong> samples of genes from them to comprise our <strong>differentially expressed</strong> (DE) sets from the genome, representing two different expression experiments.</p>

<p>How do we select these two sets of genes?</p>

<ul>
<li>define the maximum number of diff genes for the set</li>
<li>Randomly sort the GO terms</li>
<li>For each GO term in turn (i.e. iterating over the GO terms):

<ul>
<li>take a random fraction of genes for that GO term (sampling from an exponentially decaying distribution of possibilites), adding the requisite number of genes</li>
<li>If all the genes for a GO term get taken, remove that GO term from future consideration</li>
</ul></li>
<li>Continue iterating through until the total number of genes is reached</li>
</ul>

<p>What we expect from this is that in both datasets, the GO terms with lower numbers of genes annotated will have large fractions of their annotations present, while GO terms with more and more genes will have lower fractions, and there will be less overlap between the two datasets.</p>

<p>These expectations should be checked.</p>

<pre><code class="r">useGO &lt;- c(GO_low, GO_med, GO_hi)
goList &lt;- list(low = GO_low, med = GO_med, hi = GO_hi)
nGene &lt;- 1000
sample1_org &lt;- sampleTerms(useGO, hsGO, 1000, 4)[1:nGene]
sample2_org &lt;- sampleTerms(useGO, hsGO, 1000, 4)[1:nGene]
</code></pre>

<h3>Checking our expectations about the fractions of GO terms.</h3>

<pre><code class="r">goFractions &lt;- calcFraction(hsGO[useGO], list(sample1 = sample1_org, sample2 = sample2_org))
ggplot(goFractions, aes(x = size, y = frac, color = genelist)) + geom_point()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk checkFractions"/> </p>

<h3>Do calculations</h3>

<p>For each <code>geneList</code>, we will do the GO enrichment calculations, and then get the results. We also do the intersection of all the <code>geneList</code>&#39;s, and do the calculations again.</p>

<pre><code class="r">samples_noNoise &lt;- list(sample1 = sample1_org, sample2 = sample2_org)
go_noNoise &lt;- hyperGOMultiEnrichment(samples_noNoise, universe = universeGenes)
</code></pre>

<p>Now get the p-values out (<code>-1 * log10(pvalue)</code>). For each of our test GO terms, we take the minimum p-value from the results of the <strong>set</strong> calculations, and also the values from the <strong>list</strong> calculations.</p>

<pre><code class="r">noNoise_pvalues &lt;- pvaluesMultiEnrich(c(&quot;sample1&quot;, &quot;sample2&quot;), useGO, go_noNoise)

noNoise_pvalues &lt;- pvalueDiffSig(noNoise_pvalues, pCutoff = 0.05, log = TRUE)
</code></pre>

<p>Finally, lets add in our values of the fraction, total genes, and the class (<strong>low</strong>, <strong>med</strong>, <strong>hi</strong>) so we can do some fancy plotting stuff with it.</p>

<pre><code class="r">sizeClass &lt;- rep(c(&quot;low&quot;, &quot;med&quot;, &quot;hi&quot;), each = 20)
names(sizeClass) &lt;- useGO
noNoise_pvalues$sizeClass &lt;- sizeClass
noNoise_pvalues$size &lt;- goFractions[1:60, 4]
noNoise_pvalues$frac &lt;- goFractions$frac[1:60]
</code></pre>

<p>Now we will plot the difference in log-p-values (where we have <strong>set</strong> - <strong>list</strong>), so that positive values imply that <strong>set</strong> had lower p-values than <strong>list</strong>, based on the <em>fraction</em> of genes annotated.</p>

<pre><code class="r">noNoise_pvalues$sizeClass &lt;- factor(noNoise_pvalues$sizeClass, levels = c(&quot;low&quot;, 
    &quot;med&quot;, &quot;hi&quot;), ordered = TRUE)
ggplot(noNoise_pvalues, aes(x = frac, y = diff, color = sigState)) + geom_point() + 
    facet_grid(. ~ sizeClass, scales = &quot;free_x&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk noNoisePlotStuff"/> </p>

<pre><code class="r">ggplot(noNoise_pvalues, aes(x = sizeClass, y = diff)) + geom_boxplot() + geom_point()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk noNoisePlotStuff"/> </p>

<p>We can see that it appears in general that <strong>set</strong> has better p-values than <strong>list</strong>, especially in the <em>med</em> and <em>hi</em> groups. Also, both methods get pretty much the same GO terms as significant. </p>

<p>How many of the GO terms have better p-values in <strong>set</strong> compared to <strong>list</strong>?</p>

<pre><code class="r">tapply(noNoise_pvalues$diff, noNoise_pvalues$sizeClass, function(x) {
    sum(x &gt; 0)
})
</code></pre>

<pre><code>## low med  hi 
##   9  15  18
</code></pre>

<p>What is the average difference among each group?</p>

<pre><code class="r">tapply(noNoise_pvalues$diff, noNoise_pvalues$sizeClass, mean)
</code></pre>

<pre><code>##     low     med      hi 
## -0.7486  5.4314 16.5180
</code></pre>

<p>So ideally, the mean of the full set of differences, combined with how many pass in each case, should adequately quantify how well each of the methods is doing. </p>

<h2>Noise</h2>

<p>In addition to the genes that are annotated to the GO terms of interest, we will also add in genes that have no relation to the GO terms under consideration, these would be considered <strong>noise</strong> genes. To make the model simple, we will have the <strong>same</strong> genes as noise in <strong>both</strong> samples.</p>

<pre><code class="r">nNoise &lt;- 500
gene2HsGO &lt;- reverseSplit(hsGO)
not_useGO &lt;- sapply(gene2HsGO, function(x) {
    sum(x %in% useGO) == 0
})
noiseGenes &lt;- names(not_useGO)[not_useGO]
noiseGenes &lt;- sample(noiseGenes, nNoise)

# check that we did this right, the fraction should not change after adding
# noise genes
sample1 &lt;- c(sample1_org, noiseGenes)
sample2 &lt;- c(sample2_org, noiseGenes)

samplesNoise &lt;- list(sample1 = sample1, sample2 = sample2)

goFracNoise &lt;- calcFraction(hsGO[useGO], samplesNoise)
plot(goFracNoise$frac, goFractions$frac)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk noiseGenes"/> </p>

<pre><code class="r">go_noise &lt;- hyperGOMultiEnrichment(samplesNoise, universeGenes)
</code></pre>

<pre><code class="r">noise_pvalues &lt;- pvaluesMultiEnrich(c(&quot;sample1&quot;, &quot;sample2&quot;), useGO, go_noise)

noise_pvalues &lt;- pvalueDiffSig(noise_pvalues, pCutoff = 0.05, log = TRUE)

noise_pvalues$sizeClass &lt;- sizeClass
noise_pvalues$size &lt;- goFracNoise[1:60, 4]
noise_pvalues$frac &lt;- goFracNoise$frac[1:60]
</code></pre>

<pre><code class="r">noise_pvalues$sizeClass &lt;- factor(noise_pvalues$sizeClass, c(&quot;low&quot;, &quot;med&quot;, &quot;hi&quot;), 
    ordered = TRUE)
ggplot(noise_pvalues, aes(x = frac, y = diff, color = sigState)) + geom_point() + 
    facet_grid(. ~ sizeClass, scales = &quot;free_x&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk plotSummarizeNoise"/> </p>

<pre><code class="r">tapply(noise_pvalues$diff, noise_pvalues$sizeClass, function(x) {
    sum(x &gt; 0)
})
</code></pre>

<pre><code>## low med  hi 
##  11  17  20
</code></pre>

<pre><code class="r">tapply(noise_pvalues$diff, noise_pvalues$sizeClass, mean)
</code></pre>

<pre><code>##     low     med      hi 
##  0.3389  9.9506 16.7944
</code></pre>

<p>Although using gene lists that were perfect (i.e. no noise) everything in the <strong>list</strong> method was pretty much still significant, on average <strong>sets</strong> gave much better p-values. However, as we add noise to the system in the form of genes that are not annotated to our test GO terms, more terms are significant only in the <strong>sets</strong> method (i.e. show up in <strong>both</strong> sets). </p>

<h2>Expectations</h2>

<p>Based on the above results, what I expect we will see if we do a programmatic search over the space is that there is a dependence on both the fraction of DE genes that are noisy, and the fraction of noisy genes that are shared (which really amounts to the same thing, but is a subtle point). </p>

<h1>To Do:</h1>

<ul>
<li>Check expectations of the gene to GO distribution from a couple of real human data sets</li>
<li>Run both the <strong>noNoise</strong> and <strong>noise</strong> 100 times with different sets of GO terms and make sure that this holds.</li>
<li>Vary the fraction of noise genes, and also vary the fraction that is common, and find a way to quantify the effect.</li>
</ul>

</body>

</html>
